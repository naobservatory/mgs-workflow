# Troubleshooting

We break down the issues that can arise into two categories:

- Nextflow isn't able to run
- Nextflow runs then fails

We discuss each of these issues below.

## Nextflow isn't able to run

**The most common sources of errors are AWS permission issues.** Whether you're using the `batch` profile or not, you should make sure you have all AWS permissions, as specified in [our Batch tutorial](./batch.md#step-0-set-up-your-aws-credentials).

Next, make sure Nextflow has access to your AWS credentials (if not you may get `AccessDenied` errors):

```
eval "$(aws configure export-credentials --format env)"
```

## Nextflow runs then fails


### None of my jobs are running

The first time a pipeline is run on any dataset, it can take a while for the jobs to start (10-15 minutes at most). If after this period of time, none of your jobs have started, then this may be another AWS permission issue.

### Docker image failure

Another common issue is for processes to fail with some variation of the following Docker-related error:

```
docker: failed to register layer: write /usr/lib/jvm/java-11-openjdk-amd64/lib/modules: **no space left on device**.
```

This is a fairly well-known problem, which can arise even when there is substantial free storage space accessible to your EC2 instance. Following the steps recommended [here](https://www.baeldung.com/linux/docker-fix-no-space-error) or [here](https://forums.docker.com/t/docker-no-space-left-on-device/69205) typically resolves the issue, either by deleting Docker assets to free up space (e.g. via `docker system prune --all --force`) or by giving Docker more space.

### Insufficient resources

This an issue we're actively working on. Sometimes your jobs may fail due to insufficient memory or CPU resources. To avoid this, you can either change your overall resources or change the resources for a specific process:

- **Change your overall resources**: You can change the resources for your entire pipeline by editing the `configs/resources.config` file. However, note that this will probably also require you to change the reference files and indices generated by the `index` workflow. [See here for more information on compute resource requirements](./usage#compute-resource-requirements).
- **Change the resources for a specific process**: You can change the resources for a specific process by changing the label of that process to another label that is in the `configs/resources.config` file or you can define a new label in the `configs/resources.config` file.


### Rate limit exceeded

Occassionally, you may encounter the following error:

```
Task failed to start - CannotPullImageManifestError: Error response from daemon: toomanyrequests: Request exceeded pull rate limit for IP XX.XXX.XX.XX
```

This is an issue with AWS Batch. The solution is to restart your run with the nextflow `-resume` option.