# Columns of `virus_hits_final.tsv.gz`:

This file represents the main output file. The columns can be broken down into three categories:

1. Those with the prefix `aligner_`, which contain information from the [LCA](docs/lca.md) algorithm.
2. Those with the prefix `prim_align_`, which contain information from the primary alignment for each read (generated by Bowtie2 or Minimap2).
3. Those with no prefix, which contain information about each read (generated by Bowtie2 or Minimap2).

Below, we've separated out the columns we expect are most relevant to most users ("Key columns"). Those interested in getting more information about how the LCA algorithm works can visit `docs/run.md`, and those who want more information regarding the reads can visit the intermediate file `docs/lca_intermediates.md`.

## Key columns
- `seq_id`: Name of read that was identified as a viral hit
- `sample`: Name of the sample that this read came from
- `aligner_taxid_lca`: The NCBI taxon ID for the lowest common ancestor (LCA) of natural alignments only.
- `aligner_length_normalized_score_mean`: The average alignment score for natural alignments only. 
- `aligner_n_assignments`: The total number of natural alignments for that read. 
- `aligner_n_assignments_artificial`: The total number of artificial alignments for that read. 
- `prim_align_genome_id_all`: GenBank IDs for viral genomes matching forward and reverse reads, joined by "/". For single-read data, this is the same as `genome_id` 
- `prim_align_fragment_length`: Inferred fragment length, as calculated by the aligner (NA if forward and reverse reads align to different genome IDs/align discordantly). For single-read data, this column doesn't exist. 
- `prim_align_ref_start`: Location of start of alignment on reference (for paired-end data, location of forward read alignment on reference) 
- `prim_align_ref_start_rev`: Location of start of alignment of reverse read on reference. For single-read data, this column doesn't exist. 
- `query_len`: Length of read, after trimming (for paired-end data, length of forward read) 
- `query_len_rev`: Length of reverse read. For single-read data, this column doesn't exist. 
- `query_seq`: Sequence of read (for paired-end data, sequence of forward read). Not reverse-complemented (we undo any reverse-complement performed by aligner). Note that forward and reverse read is arbitrary (for those looking for duplicates, this means that you might try looking for duplicates by reversing the reads). 
- `query_seq_rev`: Sequence of reverse read. Like query_seq, not reverse-complemented. For single-read data, this column doesn't exist. 
- `query_qual`: PHRED quality scores for read (for paired-end data, quality scores for forward read). Like `query_seq`, not reverse-complemented. 
- `query_qual_rev`: PHRED quality scores for reverse read. For single-read data, this column doesn't exist. 

## Other columns
- `aligner_taxid_top`: The taxon ID of the top-scoring alignment out of natural alignments only
- `aligner_taxid_lca_combined`: The NCBI taxon ID for the lowest common ancestor (LCA) of all alignments (natural + artificial).
- `aligner_length_normalized_score_mean_combined`: The average alignment score for all alignments (natural + artificial).
- `aligner_taxid_lca_artificial`: The NCBI taxon ID for the lowest common ancestor (LCA) of artificial alignments only.
- `aligner_length_normalized_score_mean_artificial`: The average alignment score for artificial alignments only.
- `prim_align_taxid_all`: NCBI taxon ID for taxons matching forward and reverse reads, joined by "/". For single-read data, this is the same as `taxid`.
- `prim_align_best_alignment_score`: Alignment score (directly from aligner) of best-scoring alignment (for paired-end data, score for forward read's best alignment).
- `prim_align_best_alignment_score_rev`: Alignment score of best-scoring alignment of reverse read. For single-read data, this column doesn't exist.
- `prim_align_edit_distance`: Edit distance between read and aligned genome (for paired-end data, edit distance for forward read)
- `prim_align_edit_distance_rev`: Edit distance between reverse read and aligned genome. For single-read data, this column doesn't exist.
- `prim_align_map_qual`: Mapping quality (MAPQ) as returned by bowtie2/minimap2 (for paired-end data, mapping quality of forward read)
- `prim_align_map_qual_rev`: Mapping quality (MAPQ) of reverse read. For single-read data, this column doesn't exist.
- `prim_align_cigar`: CIGAR string representing alignment of read to aligned genome (for paired-end data, CIGAR string for forward read). Note that this is the CIGAR string as returned by the aligner. If `query_rc` is true, you should reverse-complement the query sequence before comparing it against the CIGAR string.
- `prim_align_cigar_rev`: CIGAR string representing alignment of reverse read to aligned genome. For single-read data, this column doesn't exist.
- `prim_align_query_rc`: A boolean (`True`/`False`) value indicating if the query was reverse-complemented by aligner.
- `prim_align_query_rc_rev`: A boolean (`True`/`False`) value indicating if the (reverse-read) query was reverse-complemented by aligner. For single-read data, this column doesn't exist.
- `prim_align_pair_status`: Pair status (UU for unpaired, CP for concordant pair, DP for discordant pair, UP for unaligned pair). For single-read data, this column doesn't exist.
