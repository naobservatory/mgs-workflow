/************************************************
| CONFIGURATION FILE FOR NAO VIRAL MGS WORKFLOW |
************************************************/

params {
    mode = "run"

    read_type = "single_end"

    // Directories
    base_dir = "s3://nao-mgs-simon/test_single_read" // Parent for working and output directories (can be S3)
    raw_dir = "${base_dir}/raw" // Raw data directory
    ref_dir = "s3://nao-mgs-wb/index-20240714/output" // Reference/index directory (generated by index workflow)

    // Files
    library_tab = "${base_dir}/libraries.csv" // Path to library TSV
    sample_tab = "${params.library_tab}" // Path to sample TSV (can be same as library tab if 1:1 mapping)
    adapters = "${projectDir}/ref/adapters.fasta" // Path to adapter file for adapter trimming

    // Numerical
    n_reads_trunc = 0 // Number of reads per sample to run through pipeline (0 = all reads)
    n_reads_profile = 1000000 // Number of reads per sample to run through taxonomic profiling
    bt2_score_threshold = 20 // Normalized score threshold for HV calling (typically 15 or 20)
    blast_hv_fraction = 0 // Fraction of putative HV reads to BLAST vs nt (0 = don't run BLAST)
    kraken_memory = "128 GB" // Memory needed to safely load Kraken DB
    quality_encoding = "phred33" // FASTQ quality encoding (probably phred33, maybe phred64)

    // Raw read file suffixes
    r1_suffix = "_1"
    r2_suffix = "_2"
}

includeConfig "${projectDir}/configs/containers.config"
includeConfig "${projectDir}/configs/resources.config"
includeConfig "${projectDir}/configs/profiles.config"
process.queue = "simon-batch-queue" // AWS Batch job queue

